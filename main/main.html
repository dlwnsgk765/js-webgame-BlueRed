<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>webgame</title>
    <script
      src="https://code.jquery.com/jquery-3.7.1.js"
      integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4="
      crossorigin="anonymous"
    ></script>
    <style>
      #stage {
        position: absolute;
        border: 1px solid;
        width: 1600px;
        height: 800px;
        background-image: url(images/BackGround.png);
        background-size: cover;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
      }
      #explain {
        border: 1px solid;
        text-align: center;
      }
      #player {
        position: absolute;
        width: 200px;
        height: 200px;
      }
    </style>
  </head>
  <body>
    <div id="stage">
      <img src="images/player-blue.gif" alt="" id="player" />
    </div>
    <audio src="sounds/changeSound.wav" id="audio"></audio>
    <div id="explain">
      설명<br />
      1. 상, 하, 좌, 우키로 움직이세요<br />
      2. 스페이스바로 캐릭터를 빨강, 파랑색으로 변경하세요<br />
      3. 떨어지는 공을 색깔에 맞게 변경해서 맞닿으세요<br />
      4. 검정 공을 피하세요<br />
    </div>
    <script>
      const player = $("#player");
      const audio = document.getElementById("audio");

      const states = {
        BLUE: "BLUE",
        RED: "RED",
      };

      let currentState = states.BLUE;

      function update() {
        
        // 게임 업데이트 루프
      }

      // 업데이트 함수를 일정 주기로 호출
      setInterval(update, 1000 / 144);

      function moveRight() {
        const playerRight = parseInt(player.css("right"), 10);
        if (playerRight <= 0) {
          return;
        }
        player.css({ left: "+=100px" });
        player.css({ transform: "scaleX(-1)" }); // 이미지를 좌우로 반전
      }

      function moveLeft() {
        const playerLeft = parseInt(player.css("left"), 10);
        if (playerLeft <= 0) {
          return;
        }
        player.css({ left: "-=100px" });
        player.css({ transform: "scaleX(1)" }); // 이미지를 좌우로 반전
      }

      function moveUp() {
        const playerTop = parseInt(player.css("top"), 10);
        if (playerTop <= 0) {
          return;
        }
        player.css({ top: "-=100px" });
      }

      function moveDown() {
        const playerBottom = parseInt(player.css("bottom"), 10);
        if (playerBottom <= 0) {
          return;
        }
        player.css({ top: "+=100px" });
      }

      function changeColor() {
        if (currentState === states.BLUE) {
          currentState = states.RED;
          player.attr("src", "images/player-red.gif");
        } else if (currentState === states.RED) {
          currentState = states.BLUE;
          player.attr("src", "images/player-blue.gif");
        }

        // 오디오 재생
        audio.play();
      }

      
      $(document).keydown(function (event) {
        switch (event.key) {
          case "d":
          case "ArrowRight":
            moveRight();
            break;
          case "a":
          case "ArrowLeft":
            moveLeft();
            break;
          case "w":
          case "ArrowUp":
            moveUp();
            break;
          case "s":
          case "ArrowDown":
            moveDown();
            break;
          case " ":
            changeColor();
            
            break;
        }
      });
      function createRandomImage() {
        let randomImageSrc;
        const randomNumber = Math.random();
        if (randomNumber < 0.33) {
          randomImageSrc = "images/red.png";
        } else if (randomNumber < 0.67) {
          randomImageSrc = "images/blue.png";
        } else {
          randomImageSrc = "images/black.png";
        }

        // 새 이미지 엘리먼트를 생성하고 추가
        const newImage = document.createElement("img");
        newImage.src = randomImageSrc;
        newImage.classList.add("randomImage");
        newImage.style.width = "100px"; // 이미지의 너비 설정
        newImage.style.height = "100px"; // 이미지의 높이 설정

        // 스테이지 너비와 높이를 고려하여 랜덤 위치 설정
        const stage = document.getElementById("stage");
        let stageWidth = stage.clientWidth;
        let stageHeight = stage.clientHeight;
        let randomLeft = Math.random() * (stageWidth - 100);
        let randomTop = Math.random() * (stageHeight - 100);
        newImage.style.left = `${randomLeft}px`;
        newImage.style.top = `${randomTop}px`;

        stage.appendChild(newImage);
      }

    </script>
  </body>
</html>
